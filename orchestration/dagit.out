2021-03-18 08:58:05 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - ENGINE_EVENT - Starting initialization of resources [io_manager, snowflake].
2021-03-18 08:58:05 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - ENGINE_EVENT - Finished initialization of resources [io_manager, snowflake].
2021-03-18 08:58:05 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - PIPELINE_START - Started execution of pipeline "transform_data_pipeline".
2021-03-18 08:58:05 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - ENGINE_EVENT - Executing steps in process (pid: 13699)
2021-03-18 08:58:05 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - launch_snowpipe - STEP_START - Started execution of step "launch_snowpipe".
2021-03-18 08:58:05 - dagster - INFO - resource:snowflake - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - Executing query: alter pipe gdelt_events_pipe refresh;
2021-03-18 08:58:06 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - launch_snowpipe - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
2021-03-18 08:58:06 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - launch_snowpipe - HANDLED_OUTPUT - Handled output "result" using output manager "io_manager"
2021-03-18 08:58:06 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - launch_snowpipe - STEP_SUCCESS - Finished execution of step "launch_snowpipe" in 1.44s.
2021-03-18 08:58:06 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_START - Started execution of step "run_dbt_transformation".
/Users/olivierdupuis/.pyenv/versions/3.7.4/envs/venv_dio_dw/lib/python3.7/site-packages/dagster/core/definitions/decorators/solid.py:233: ExperimentalWarning: "dbt_cli_run" is an experimental function. It may break in future versions, even between dot releases. To mute warnings for experimental functionality, invoke warnings.filterwarnings("ignore", category=dagster.ExperimentalWarning) or use one of the other methods described at https://docs.python.org/3/library/warnings.html#describing-warning-filters.
  result = fn(context, **kwargs)
2021-03-18 08:58:06 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - Executing command: dbt --log-format json run --project-dir /Users/olivierdupuis/Git/dio/data_stack/orchestration/../dw --profiles-dir .
2021-03-18 08:58:07 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - Running with dbt=0.18.1
2021-03-18 08:58:09 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - Found 3 models, 4 tests, 0 snapshots, 1 analysis, 318 macros, 0 operations, 0 seed files, 1 source
2021-03-18 08:58:14 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:14 | Concurrency: 1 threads (target='analytics')
2021-03-18 08:58:14 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:14 | 1 of 3 START view model dbt_odupuis_staging.stg_gdelt_events......... [RUN]
2021-03-18 08:58:15 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:15 | 1 of 3 OK created view model dbt_odupuis_staging.stg_gdelt_events.... [[32mSUCCESS 1[0m in 1.18s]
2021-03-18 08:58:15 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:15 | 2 of 3 START view model dbt_odupuis_integration.int_events........... [RUN]
2021-03-18 08:58:16 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:16 | 2 of 3 OK created view model dbt_odupuis_integration.int_events...... [[32mSUCCESS 1[0m in 1.14s]
2021-03-18 08:58:16 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:16 | 3 of 3 START incremental model dbt_odupuis.events_fact............... [RUN]
2021-03-18 08:58:22 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:22 | 3 of 3 OK created incremental model dbt_odupuis.events_fact.......... [[32mSUCCESS 111[0m in 5.34s]
2021-03-18 08:58:23 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 08:58:23 | Finished running 2 view models, 1 incremental model in 14.07s.
2021-03-18 08:58:23 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - [32mCompleted successfully[0m
2021-03-18 08:58:23 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-03-18 08:58:23 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - run_dbt_transformation - dbt exited with return code 0
2021-03-18 08:58:23 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_MATERIALIZATION - dbt node: model.dio_dw.stg_gdelt_events
2021-03-18 08:58:23 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_MATERIALIZATION - dbt node: model.dio_dw.int_events
2021-03-18 08:58:23 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_MATERIALIZATION - dbt node: model.dio_dw.wh_events_fact
2021-03-18 08:58:23 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_MATERIALIZATION - Output from the CLI execution of `dbt run`.
2021-03-18 08:58:24 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_OUTPUT - Yielded output "dbt_output" of type "DbtCliOutput". (Type check passed).
2021-03-18 08:58:24 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - HANDLED_OUTPUT - Handled output "dbt_output" using output manager "io_manager"
2021-03-18 08:58:24 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - run_dbt_transformation - STEP_SUCCESS - Finished execution of step "run_dbt_transformation" in 17.36s.
2021-03-18 08:58:24 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - test_dbt_transformation - STEP_START - Started execution of step "test_dbt_transformation".
/Users/olivierdupuis/.pyenv/versions/3.7.4/envs/venv_dio_dw/lib/python3.7/site-packages/dagster/core/definitions/decorators/solid.py:233: ExperimentalWarning: "dbt_cli_test" is an experimental function. It may break in future versions, even between dot releases. To mute warnings for experimental functionality, invoke warnings.filterwarnings("ignore", category=dagster.ExperimentalWarning) or use one of the other methods described at https://docs.python.org/3/library/warnings.html#describing-warning-filters.
  result = fn(context, **kwargs)
2021-03-18 08:58:24 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - Executing command: dbt --log-format json test --project-dir /Users/olivierdupuis/Git/dio/data_stack/orchestration/../dw --profiles-dir .
2021-03-18 08:58:24 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - Running with dbt=0.18.1
2021-03-18 08:58:26 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - Found 3 models, 4 tests, 0 snapshots, 1 analysis, 318 macros, 0 operations, 0 seed files, 1 source
2021-03-18 08:58:29 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:29 | Concurrency: 1 threads (target='analytics')
2021-03-18 08:58:29 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:29 | 1 of 4 START test dbt_utils_at_least_one_stg_gdelt_events_gdelt_event_natural_key [RUN]
2021-03-18 08:58:31 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:31 | 1 of 4 PASS dbt_utils_at_least_one_stg_gdelt_events_gdelt_event_natural_key [[32mPASS[0m in 2.05s]
2021-03-18 08:58:31 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:31 | 2 of 4 START test not_null_stg_gdelt_events_gdelt_event_natural_key.. [RUN]
2021-03-18 08:58:32 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:32 | 2 of 4 PASS not_null_stg_gdelt_events_gdelt_event_natural_key........ [[32mPASS[0m in 1.30s]
2021-03-18 08:58:32 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:32 | 3 of 4 START test not_null_wh_events_fact_event_pk................... [RUN]
2021-03-18 08:58:33 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:33 | 3 of 4 PASS not_null_wh_events_fact_event_pk......................... [[32mPASS[0m in 1.08s]
2021-03-18 08:58:33 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:33 | 4 of 4 START test unique_wh_events_fact_event_pk..................... [RUN]
2021-03-18 08:58:35 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:35 | 4 of 4 PASS unique_wh_events_fact_event_pk........................... [[32mPASS[0m in 1.41s]
2021-03-18 08:58:35 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 08:58:35 | Finished running 4 tests in 8.38s.
2021-03-18 08:58:35 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - [32mCompleted successfully[0m
2021-03-18 08:58:35 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-03-18 08:58:35 - dagster - INFO - system - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - test_dbt_transformation - dbt exited with return code 0
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - test_dbt_transformation - STEP_MATERIALIZATION - Output from the CLI execution of `dbt test`.
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - test_dbt_transformation - STEP_OUTPUT - Yielded output "dbt_output" of type "DbtCliOutput". (Type check passed).
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - test_dbt_transformation - HANDLED_OUTPUT - Handled output "dbt_output" using output manager "io_manager"
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - test_dbt_transformation - STEP_SUCCESS - Finished execution of step "test_dbt_transformation" in 11.53s.
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - ENGINE_EVENT - Finished steps in process (pid: 13699) in 30.5s
2021-03-18 08:58:35 - dagster - DEBUG - transform_data_pipeline - 7d88a41e-698b-4904-8fa0-dc62ec12aff3 - 13699 - PIPELINE_SUCCESS - Finished execution of pipeline "transform_data_pipeline".
